======================================================================
CLUSTER-AWARE PREDICTION STRATEGY
======================================================================

Loading data...

Engineering features...

Engineering features...

======================================================================
ANALYZING POTENTIAL IMPROVEMENTS
======================================================================

Identifying 15 clusters...

Baseline errors by cluster:
  Cluster 2: 89/1661 = 5.4%
  Cluster 7: 28/521 = 5.4%
  Cluster 6: 48/2437 = 2.0%
  Cluster 0: 24/1902 = 1.3%
  Cluster 12: 8/157 = 5.1%

Potential fixes by cluster rules:
  Cluster 2: 0 errors could be fixed
  Cluster 7: 0 errors could be fixed

Total potential fixes: 0 (0.0% of errors)

======================================================================
VALIDATING CLUSTER-AWARE STRATEGY
======================================================================

Fold 1/5

Identifying 15 clusters...

Identifying outliers with DBSCAN...
Found 133 outliers (0.90%)

Identifying outliers with DBSCAN...
Found 96 outliers (2.59%)

Training cluster-aware ensemble...
Training XGBoost...
Training CatBoost...
Training LightGBM (as NN substitute)...

Making cluster-aware predictions...
Applying conservative threshold (0.6) for 96 outliers

Applying cluster-specific rules...
Modified 0 predictions based on cluster rules
Fold 1 accuracy: 0.969771

Fold 2/5

Identifying 15 clusters...

Identifying outliers with DBSCAN...
Found 113 outliers (0.76%)

Identifying outliers with DBSCAN...
Found 98 outliers (2.65%)

Training cluster-aware ensemble...
Training XGBoost...
Training CatBoost...
Training LightGBM (as NN substitute)...

Making cluster-aware predictions...
Applying conservative threshold (0.6) for 98 outliers

Applying cluster-specific rules...
Modified 0 predictions based on cluster rules
Fold 2 accuracy: 0.966262

Fold 3/5

Identifying 15 clusters...

Identifying outliers with DBSCAN...
Found 110 outliers (0.74%)

Identifying outliers with DBSCAN...
Found 120 outliers (3.24%)

Training cluster-aware ensemble...
Training XGBoost...
Training CatBoost...
Training LightGBM (as NN substitute)...

Making cluster-aware predictions...
Applying conservative threshold (0.6) for 120 outliers

Applying cluster-specific rules...
Modified 0 predictions based on cluster rules
Fold 3 accuracy: 0.964912

Fold 4/5

Identifying 15 clusters...

Identifying outliers with DBSCAN...
Found 136 outliers (0.92%)

Identifying outliers with DBSCAN...
Found 117 outliers (3.16%)

Training cluster-aware ensemble...
Training XGBoost...
Training CatBoost...
Training LightGBM (as NN substitute)...

Making cluster-aware predictions...
Applying conservative threshold (0.6) for 117 outliers

Applying cluster-specific rules...
Modified 0 predictions based on cluster rules
Fold 4 accuracy: 0.970850

Fold 5/5

Identifying 15 clusters...

Identifying outliers with DBSCAN...
Found 145 outliers (0.98%)

Identifying outliers with DBSCAN...
Found 73 outliers (1.97%)

Training cluster-aware ensemble...
Training XGBoost...
Training CatBoost...
Training LightGBM (as NN substitute)...

Making cluster-aware predictions...
Applying conservative threshold (0.6) for 73 outliers

Applying cluster-specific rules...
Modified 0 predictions based on cluster rules
Fold 5 accuracy: 0.971112

Mean CV accuracy: 0.968581 (+/- 0.002522)

======================================================================
TRAINING FINAL MODEL
======================================================================

Identifying 15 clusters...

Identifying outliers with DBSCAN...
Found 122 outliers (0.66%)

Identifying outliers with DBSCAN...
Found 138 outliers (2.23%)

Training cluster-aware ensemble...
Training XGBoost...
Training CatBoost...
Training LightGBM (as NN substitute)...

Handling outliers with k-NN...
Made predictions for 138 test outliers

Making cluster-aware predictions...
Applying conservative threshold (0.6) for 138 outliers

Applying cluster-specific rules...
Modified 0 predictions based on cluster rules

Saved submission to: output/cluster_aware_submission.csv
Saved detailed predictions to: output/cluster_aware_predictions_detailed.csv

======================================================================
SUMMARY
======================================================================

CV Score: 0.968581
Test predictions: 4609 Extroverts, 1566 Introverts
Outliers in test: 138

Test samples by cluster:
  Cluster 2: 543 samples
  Cluster 7: 156 samples
  Cluster 6: 801 samples

======================================================================
ANALYSIS COMPLETE
======================================================================
